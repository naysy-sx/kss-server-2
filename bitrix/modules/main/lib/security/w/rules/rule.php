<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1532983736']= array(base64_decode('aXNfc3R'.'yaW5'.'n'),base64_decode('c'.'3RydG9sb3dl'.'cg='.'='),base64_decode('a'.'XN'.'fYXJy'.'YX'.'k='),base64_decode('aXNf'.'c3RyaW5'.'n'),base64_decode('Z3pkZWNvZGU='),base64_decode('YmF'.'z'.'ZTY0X2RlY29kZQ=='),base64_decode('dXJsZ'.'G'.'Vjb2'.'Rl'),base64_decode('YX'.'JyYXlfcmV2'.'ZXJzZQ=='),base64_decode('Z3'.'p'.'l'.'bmNvZGU='),base64_decode('YmFzZTY0X2VuY29kZQ=='),base64_decode('d'.'XJs'.'ZW5jb2'.'R'.'l'),base64_decode(''.'YmluMmhleA='.'='),base64_decode(''.'aXNfYXJ'.'yYX'.'k='),base64_decode('c3RydG9sb'.'3d'.'lcg='.'='),base64_decode('aXN'.'fYXJyYXk='),base64_decode(''.'am9'.'pbg=='),base64_decode('Zm5tYXRjaA'.'=='),base64_decode(''.'cmF3d'.'XJ'.'sZGVjb'.'2Rl'),base64_decode('c3'.'Vic3'.'Ry'),base64_decode('c'.'3Vic3'.'Ry'),base64_decode('c3RyX3J'.'lcG'.'x'.'hY2U='),base64_decode(''.'cHJl'.'Z19'.'xdW90'.'ZQ='.'='),base64_decode('cHJl'.'Z'.'1'.'9t'.'YXR'.'jaA=='));if(!function_exists(__NAMESPACE__.'\\___1048972524')){function ___1048972524($_1729082051){static $_1180433183= false; if($_1180433183 == false) $_1180433183=array(''.'YW'.'N0'.'aW9'.'u',''.'aW5'.'0dmFs','c'.'GF0aA==','Y'.'29udGV4d'.'A==','a2V'.'5cw==',''.'cHJvY2Vzcw==',''.'ZW5jb2Rpbmc=','cHJlZ'.'19yZXB'.'sYWNl','cGF0aA==',''.'Y'.'29udGV4dA'.'==','a2V5cw==','cHJvY2V'.'zcw==','ZW5'.'jb2Rpbmc'.'=','cG'.'F0'.'dG'.'Vybg='.'=',''.'cHJlZ1'.'9tYXRja'.'A==','cGF0'.'aA==','Y29udGV4dA==','a2V5cw==','cHJv'.'Y2Vzcw==','ZW5j'.'b2Rpbmc=',''.'cGF0d'.'GVybg==','c'.'G9'.'z'.'dF9hY3'.'Rpb'.'24=','Y2hlY'.'2tfY3NyZ'.'g='.'=','cGF0aA='.'=','Y29udG'.'V4'.'d'.'A==',''.'a2'.'V5cw'.'==','cHJvY'.'2'.'V'.'zc'.'w==','ZW5jb2'.'Rpbmc=','cGF0'.'dGVybg==','YW'.'N0aW9u','YWN0aW9u','YW'.'N0aW9u','YWN0aW'.'9u','Y'.'WN'.'0aW'.'9'.'u','YW'.'N0aW9u','cG9zdF9'.'hY3'.'Rpb24=','Z'.'W5'.'jb2Rpbmc'.'=','ZW5jb'.'2'.'Rpbm'.'c=',''.'Z'.'W5j'.'b2'.'Rpbmc=','ZW'.'5j'.'b2R'.'pbm'.'c=',''.'ZW5j'.'b2Rpbmc=','ZW5jb2'.'Rpbmc'.'=',''.'Z3o=','YmFzZTY0',''.'dX'.'Js','aGV4',''.'L'.'g==','Lw'.'==','aW5kZX'.'gucGhw','L'.'2luZGV'.'4L'.'n'.'BocA'.'==','U0NSSVB'.'UX05'.'BTU'.'U'.'=',''.'L'.'2luZG'.'V4LnBocA'.'==','U0'.'N'.'SSV'.'B'.'UX05B'.'TU'.'U=','U0'.'N'.'S'.'SVBUX'.'05'.'BT'.'UU=','U0'.'N'.'SSVBUX05BT'.'UU=','fg==','fl4=','f'.'g==','X'.'H4=','JH'.'4'.'=');return base64_decode($_1180433183[$_1729082051]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1586713563; protected $_1731228660; protected $_376516732; protected $_1312077082; protected $_1262077339; public static function make(array $_1185767262):?static{ $_1185767262= static::prepareRuleParameters($_1185767262); return match($_1185767262[___1048972524(0)]){ ___1048972524(1) => new IntvalRule( $_1185767262[___1048972524(2)], $_1185767262[___1048972524(3)], $_1185767262[___1048972524(4)], $_1185767262[___1048972524(5)], $_1185767262[___1048972524(6)]), ___1048972524(7) => new PregReplaceRule( $_1185767262[___1048972524(8)], $_1185767262[___1048972524(9)], $_1185767262[___1048972524(10)], $_1185767262[___1048972524(11)], $_1185767262[___1048972524(12)], $_1185767262[___1048972524(13)]), ___1048972524(14) => new PregMatchRule( $_1185767262[___1048972524(15)], $_1185767262[___1048972524(16)], $_1185767262[___1048972524(17)], $_1185767262[___1048972524(18)], $_1185767262[___1048972524(19)], $_1185767262[___1048972524(20)], $_1185767262[___1048972524(21)]), ___1048972524(22) => new CsrfRule( $_1185767262[___1048972524(23)], $_1185767262[___1048972524(24)], $_1185767262[___1048972524(25)], $_1185767262[___1048972524(26)], $_1185767262[___1048972524(27)], $_1185767262[___1048972524(28)],), default => null,};} protected static function prepareRuleParameters(array $_1671217579): array{ if($GLOBALS['____1532983736'][0]($_1671217579[___1048972524(29)])){ $_1671217579[___1048972524(30)]= $GLOBALS['____1532983736'][1]($_1671217579[___1048972524(31)]);} elseif($GLOBALS['____1532983736'][2]($_1671217579[___1048972524(32)])){ $_529892212= $_1671217579[___1048972524(33)]; $_1671217579[___1048972524(34)]= $_529892212[min(64,0,21.333333333333)]; $_1671217579[___1048972524(35)]= $_529892212[round(0+0.2+0.2+0.2+0.2+0.2)];} $_1671217579[___1048972524(36)]=!empty($_1671217579[___1048972524(37)])? $_1671217579[___1048972524(38)]:[]; if($GLOBALS['____1532983736'][3]($_1671217579[___1048972524(39)])){ $_1671217579[___1048972524(40)]=[$_1671217579[___1048972524(41)]];} return $_1671217579;}  public function __construct($_1586713563, $_1731228660, $_376516732, $_1312077082, $_1262077339){ $this->_1586713563= $_1586713563; $this->_1731228660= $this->castContext($_1731228660); $this->_376516732= $this->castKeys($_376516732); $this->_1312077082= $_1312077082; $this->_1262077339= $_1262077339;} public function evaluateValue($_1558985960){ if(!empty($this->_1262077339)){ foreach($this->_1262077339 as $_1961413672){ $_1558985960= match($_1961413672){ 'gz' => $GLOBALS['____1532983736'][4]($_1558985960), 'base64' => $GLOBALS['____1532983736'][5]($_1558985960), 'url' => $GLOBALS['____1532983736'][6]($_1558985960), 'hex' => hex2bin($_1558985960)};}} $_392631799= $this->evaluate($_1558985960); if(!empty($this->_1262077339) && $_392631799 instanceof ModifyResult){ $_291827769= $_392631799->getCleanValue(); foreach($GLOBALS['____1532983736'][7]($this->_1262077339) as $_1961413672){ $_291827769= match($_1961413672){ ___1048972524(42) => $GLOBALS['____1532983736'][8]($_291827769), ___1048972524(43) => $GLOBALS['____1532983736'][9]($_291827769), ___1048972524(44) => $GLOBALS['____1532983736'][10]($_291827769), ___1048972524(45) => $GLOBALS['____1532983736'][11]($_291827769)};} $_392631799= new ModifyResult($_291827769);} return $_392631799;} abstract public function evaluate($_1558985960); protected function castContext($_1731228660){ if(!$GLOBALS['____1532983736'][12]($_1731228660)){ $_1731228660=[$_1731228660];} foreach($_1731228660 as $_1542767837 => $_716041692){ $_1731228660[$_1542767837]= $GLOBALS['____1532983736'][13]($_716041692);} return $_1731228660;} protected function castKeys($_376516732){ if(!$GLOBALS['____1532983736'][14]($_376516732)){ $_376516732=[$_376516732];} return $_376516732;} public function matchKey(array $_1655722180): bool{ $_1655722180= $GLOBALS['____1532983736'][15](___1048972524(46), $_1655722180); foreach($this->_376516732 as $_963391563){   if($GLOBALS['____1532983736'][16]($_963391563, $_1655722180)){ return true;}} return false;}  public function matchPath($_712421011){ if($this->_1586713563 === '*'){ return true;}  $_1426197421= new Uri($_712421011); $_507130787= $_1426197421->getPath(); $_507130787= $GLOBALS['____1532983736'][17]($_507130787);      if(str_ends_with($_507130787, ___1048972524(47))){ $_507130787 .= ___1048972524(48);} $_507130787= Path::normalize($_507130787);  $_85203460[]= $_507130787; if(str_ends_with($_507130787, ___1048972524(49))){ $_85203460[]= $GLOBALS['____1532983736'][18]($_507130787,(224*2-448),-round(0+1.8+1.8+1.8+1.8+1.8));} elseif(str_ends_with($_SERVER[___1048972524(50)], ___1048972524(51))){ $_85203460[]= $GLOBALS['____1532983736'][19]($_SERVER[___1048972524(52)],(143*2-286),-round(0+2.25+2.25+2.25+2.25));} if($_507130787 !== $_SERVER[___1048972524(53)]){ $_85203460[]= $_SERVER[___1048972524(54)];}  if(str_starts_with($this->_1586713563, ___1048972524(55))){ $_3604665= $this->_1586713563;} else{ $_3604665= ___1048972524(56). $GLOBALS['____1532983736'][20](___1048972524(57), ___1048972524(58), $GLOBALS['____1532983736'][21]($this->_1586713563)). ___1048972524(59);} foreach($_85203460 as $_293432670){ if($this->_1586713563 === $_293432670 || $GLOBALS['____1532983736'][22]($_3604665, $_293432670)){ return true;}} return false;}  public function getPath(){ return $this->_1586713563;}  public function getContext(){ return $this->_1731228660;}  public function getKeys(){ return $this->_376516732;}  public function getProcess(){ return $this->_1312077082;}}?>